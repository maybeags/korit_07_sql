# 입실 체크 해주세요 !! 💌

# 금일 수업 계획
1. MariaDB 설치
2. HeidiSQL 조작
3. SQL문 기초

* SQLD 가채점 결과 발표됐습니다.

# MariaDB 설치과정(windows version)
chrome -> mariadb 검색
https://mariadb.org/
download 탭 -> default 설정으로 download

tcp port : 3310
id : root
pwd : 1234

mariaDB만 설정을 했는데 window + heidiSQL

깃허브 열어서 새 repository 작성하겠습니다.
korit_07_sql

git init
git config user.name "여러분깃허브아이디"
git config user.email "여러분@깃허브.이메일"

git add .
git commit -m "first commit"
git branch -M main
git remote add origin https://github.com/maybeags/korit_07_sql.git
git push -u origin main

다 진행되신 분들은 제 깃허브 리포지토리 들어오셔서
data.zip 파일을 받으신 후에 여러분 learning_logs 내에 옮기고
압축을 풉니다.

압축을 풀었을 때 여러 개의 .csv 파일을 확인할 수 있습니다.

# 새 DB 생성 방법
Unnamed -> 우클릭 -> 새로 생성 -> 새 데이터베이스
Database name : play_sql

그리고 play_sql이 녹색 체크표시 떠있는 상태에서(현재 데이터베이스가 선택되었다는 의미)  

products.csv 파일 가져오기 하려고 할 때 실패 하시는 분들 대상
그냥 오류 창 떴을 때 닫기 누르고 f5 누르면 products 테이블이 생성되어있습니다.

# 이상 까지의 과정
1. MariaDB 설치
2. MariaDB에 default DBMS 프로그램인 HeidiSQL 설치(자동 설치)
3. database 생성 -> play_sql
4. play_sql 내부에 외부의 csv 파일을 가져오기
  - 즉 이상의 부분은 이미 만들어진 데이터를 가지고 온 부분이라고 할 수 있습니다. 
  - 이상의 과정에서 products.csv를 가져올 때 문제가 있었습니다.

현재까지가 사전 준비 단계에 해당.

# RDBMS
RDBMS(관계형 데이터베이스 관리 시스템 : Relational DataBase Management System)는 데이터를 관계형 모델을 기반으로 저장, 관리, 조작하는 소프트웨어 시스템. 관계형 모델은 데이터를 테이블(릴레이션) 형식으로 표현하며, 각 테이블은 행(row), 열(coloumn)으로 구성됩니다. RDBMS는 데이터 무결성 / 일관성 / 보안 등을 유지하면서 데이터를 효율적으로 관리하고 접근할 수 있게 보조함.

## 주요 특징
1. 테이블 기반 구조 :
  - 데이터는 행(record)과 열(field)로 구성된 테이블에 저장됩니다.
  - 각 테이블은 고유의 이름을 가지며, 데이터베이스 내에서 다른 테이블과 관계 맺을 수 있습니다.
2. SQL 사용 :
  - RDBMS는 데이터를 정의하고 조작하기 위해 SQL(Structured Query Language)을 사용합니다.
  - SQL은 데이터베이스 생성 / 테이블 생성 / 데이터 삽입 / 수정 / 삭제 / 조회 등의 조작을 위한 표준 언어입니다(근데 어떤 DBMS 쓰냐에 따라 dialect가 있음).
3. 데이터 무결성 :
  - 데이터의 정확성과 일관성을 유지하기 위해 무결성 제약 조건(Primary Key, Foreign Key, Unique, Check 등)을 지원합니다. 특히 우리는 PK / FK 개념에 좀 집중할 예정입니다.
  - 트랜잭션 처리(ACID 특성 : Atomicity / Consistency / Isolation / Durability)를 통해 데이터 무결성을 보장합니다. - 기사 / 산기에 나옴.
4. 관계 설정 :
  - 테이블 간의 관계를 설정하여 데이터의 중복을 최소화하고, 데이터의 참조 무결성을 유지합니다.
  - 관계의 유형으로 일대일(1:1) / 일대다(1:N) / 다대다(N:N)가 있습니다.
5. 데이터 보안 :
  - 사용자 권한 관리 / 데이터 암호와 등을 통해 데이터베이스 보안을 강화합니다.
  - 각 사용자는 데이터베이스 / 테이블 / column 단위로 접근 권한을 설정할 수 있습니다.

## RDBMS의 주요 기능 요약
- 데이터 정의 : 테이블 / 뷰 / 인덱스 / 스키마 등을 생성하고 관리
- 데이터 조작 : 데이터 삽입 / 수정 / 삭제 / 조회를 수행
- 데이터 제어 : 트랜잭션 관리 / 동시성 제어 / 회복 기능을 제공
- 데이터 보안 : 사용자 권한 설정 / 데이터 암호화 / 감사 로그 등을 지원

# SQL 학습
## 정의
- 구조화된 질문 언어 : RDMS를 관리하기 위해 고안된 프로그래밍 언어.
### SQL은 어떻게 실행되는가 ?
- 컴퓨터에게 특정 데이터 정보를 가지고 오라고 명령할 때 필요한 정보 :
  1. '무엇'을 가지고 와야 하는지.
  2. '어디에서' 가져와야 하는지.
- 이상의 최소한의 정보들을 포함하여 컴퓨터가 알아들을 수 있고 / 또 사람이 알아볼 수 있는 형태로 구현한 것이 SQL.
```sql
SELECT * FROM users;
데이터를 가져와라(select) 전부 다(*) users라는 테이블에서(from users)
끝(;)
```
그리고 이상의 SQL문 실행하는 것을 우리나라에서는 _쿼리문을 실행했다_ , _쿼리문을 날렸다_ 등의 표현을 씁니다. SQL 명령문을 컴퓨터에 전달했다는 의미이기도 합니다.

저희는 Springboot 상황에서 Query Method라고 해서 SQL문과는 다르지만 Java 내에서 method 형태로 명령어를 정의하고, 이것을 호출했을 때 MariaDB로 접속하여 특정 데이터를 가지고 오도록 제어할 예정입니다.

## SQL의 종류
1. DML(Data Manipulation Language) : 데이터 조작 언어라는 뜻으로, 데이터 베이스의 내부 데이터를 관리하기 위한 기능. 주로 데이터를 조회하고 추가하고, 수정하거나 삭제하는 등의 기능을 수행하기 위하여 사용됨. SELECT / INSERT / UPDATE / DELETE 등이 있습니다.
  - 그리고 이상의 생성 / 조회 / 수정 / 삭제를 CRUD라고도 합니다.
    - C : Create
    - R : Read
    - U : Update
    - D : Delete
2. DDL(Data Definition Language) : 데이터 정의 언어 라는 뜻으로, 관계형 데이터베이스 내의 저장 단위인 테이블(table)과 컬럼(column)을 정의하고 관리하는 명령어를 포함한다. 저장 공간을 생성하고, 수정하거나 삭제하는 등의 주로 데이터 저장 공간을 결정하는 기능에 해당하며, 주요 명령어로는
  - CREATE
  - DROP
  - TRUNCATE 등이 있습니다.
3. DCL(Data Control Language) : 관리 목적으로 주로 사용되며, 데이터베이스에 접근하려는 사용자의 권한을 관리하거나 보안과 관련된 기능을 담당한다. 주요 명령어로는 GRANT / REVOKE 등이 있습니다(시험에는 자주 나옵니다).

4. TCL(Transaction Control Language) : 트랜잭션 제어 언어라는 의미로, 데이터베이스를 조작하는 명령 단위인 트랜잭션을 관리할 때 사용하는 기능(저는 은행을 경유하여 A고객에게서 B고객에게로 이체하는 과정을 설명할 때 얘기했습니다)을 담당한다. 주요 명령어로는 COMMIT / ROLLBACK 등이 있다.

# 주요 용어
1. 테이블(table) :
  - 관계형 데이터베이스 내에서 행과 열로 구성된 데이터를 저장하는 기본 단위.
  - 엑셀을 하나의 데이터베이스라고 한다면 테이블은 엑셀 내에서의 sheet로 볼 수 있음.
  - 각 테이블은 고유한 식별자인 기본 키(Primary Key)를 가지고 있음.
  - 기본 키는 테이블 내에서 각 행을 고유하기 식별하기 위해 사용.
  - 테이블 간의 관계를 맺을 때는 외래 키(Foreign Key)를 사용.

2. 컬럼(column) :
  - 테이블에서 하나의 속성(attribute/ Java에서는 field)에 해당하는 데이터를 저장하는 공간으로, 세로 줄인 열에 해당함.
  - 각 컬럼에는 컬럼명 / 데이터 타입 / 크기 / 제약 조건 등을 정의할 수 있음.
  - Java에서 String studentName;이라고 했다면 데이터 타입과 컬럼명을 설정했다고 볼 수 있겠네요.

3. 행(row) :
  - 테이블에서 가로줄 하나를 의미함. Record라고 부르기도 합니다.
  - 테이블에서 하나의 개별 데이터 단위를 나타내며, 특정 데이터가 저장되고 조회될 때 행 단위로 처리됨(Java에서는 객체가 됩니다.)

4. 기본 키(Primary Key / PK) :
  - 기본 키는 테이블에서 각 행(객체)을 고유하게 식별할 수 있는 값(html 태그에서의 id 값처럼 중복이 불가능합니다).
  - 기본 키는 하나가 아닌 여러 값의 조합으로 이루어질 수도 있으며, 이러한 기본 키는 테이블 내에서 중복되지 않는 유일한 값이어야 합니다.

5. 외래 키(Foreign Key / FK) :
  - 외래 키는 다른 테이블의 _기본 키_ 와 매칭되어 해당 테이블과의 관계를 정의함.
  - 다른 테이블의 기본 키 값을 가져와서 컬럼을 구성하며 이후 테이블끼리 결합(JOIN 연산 수행)할 때 사용됨.
  - 일반적으로 다른 테이블의 기본 키와 같은 데이터 타입과 크기(int / long)를 갖는다.

# products 테이블에 값 집어넣기 예시
```sql
INSERT INTO products (id, name, price, discount_price) VALUES
(1, 'Terrarossa', 18, 18),
(2, 'Mini Chee', 19, 19),
(3, 'Beanboth', 10, 10),
(4, 'Starbucks P', 21, 21),
(5, 'Organic P', 21.5, 21.5),
(6, 'Grandma Z', 29, 29),
(7, 'Uncle Bob', 30, 30),
(8, 'Northwood', 40, 40),
(9, 'Mishi Keb', 32, 32),
(10, 'Nike Men''', 31, 31),
(11, 'Newbalan', 21.5, 21.5),
(12, 'Quego Ma', 38, 38),
(13, 'Konbu Tea', 6, 6),
(14, 'Guilong G', 23.23, 23.23),
(15, 'Senen Sh', 15.5, 10.5),
(16, 'Robio Cho', 17.45, 17),
(17, 'Alite Mul', 39, 39),
(18, 'Carnarvon', 62.5, 62.5),
(19, 'Feather G', 52, 52),
(20, 'Sir Rodney', 81, 70),
(21, 'Air Iche', 10, 10),
(22, 'Air Iche', 21, 15),
(23, 'Bicycle Pa', 9, 7),
(24, 'Snono Sp', 49.99, 39.99),
(25, 'Doon Pour', 23.85, 23.85),
(26, 'JBL FLIP 5', 109, 109),
(27, 'Shinogi S', 43.9, 43.9),
(28, 'ABRAMTE', 99, 89),
(29, 'Boosiey H', 123.79, 89),
(30, 'Nord-Osb', 25.89, 25.89),
(31, 'Gorgonzo', 12.5, 12.5),
(32, 'Macar Poin', 55, 55),
(33, 'Geitost', 2.5, 2.5),
(34, 'Sasquatch', 14, 14),
(35, 'Steepbe H', 18, 18),
(36, 'Inlagd Sill', 19, 19),
(37, 'Graved lox', 20, 20),
(38, 'Thiswork', 263.81, 263.81),
(39, 'Chartreuse', 18, 18),
(40, 'Brocken B', 18.5, 18.5),
(41, 'Jack''s New', 9.65, 9.65),
(42, 'Singapor', 14, 14),
(43, 'Ipora Coffe', 46, 46),
(44, 'Guia Malal', 19.45, 19.45),
(45, 'THE ORGA', 11, 9.5),
(46, 'Spegelsild', 12, 12),
(47, 'Zaanser K', 9.5, 9.5),
(48, 'Chocolad', 12.75, 12.75),
(49, 'Maxillaku', 20, 20),
(50, 'Valkoinen', 16.25, 16.25),
(51, 'Manjimus', 5.3, 5.3),
(52, 'Pilo Mix', 7, 7),
(53, 'North-West', 32.5, 32.5),
(54, 'OLD BAY', 36, 33),
(55, 'India Tree', 9.95, 9),
(56, 'Soncolli d', 38, 38),
(57, 'Ravioli an', 19.5, 19.5),
(58, 'Escargots', 13.25, 13.25),
(59, 'Raclette C', 55, 55),
(60, 'Canembe', 34, 34),
(61, 'Planters P', 22, 16),
(62, 'Tarte au s', 49.3, 49.3),
(63, 'Veggie-sp', 33.9, 33.9),
(64, 'Corn Smitt', 33.25, 33.25),
(65, 'Louisiana', 21.05, 21.05),
(66, 'Louisiana', 17, 17),
(67, 'Laughing', 14, 14),
(68, 'Scottish L', 12.5, 10.5),
(69, 'Outbound', 38, 32),
(70, 'Outback L', 15, 15),
(71, 'Nutta Sa', 21.4, 21.4),
(72, 'Mozzarella', 34.8, 34.8),
(73, 'Burbaber', 15, 13.99),
(74, 'Elkessan Of', 10, 10),
(75, 'SANSUNG', 499.99, 349.99),
(76, 'Massaged l', 39.9, 39.9),
(77, 'Womens Li', 37.99, 37.99);
```

# SQL문의 예시 포함 설명
1. DDL
  - CREATE / ALTER / DROP
  - 저희는 테이블을 클릭클릭으로 만들었지만 원래 CLI에서는 테이블 만드는 것도 명령어로 처리합니다. 이하는 그 예시
```sql
  CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,    컬럼 # 1
    username VARCHAR(50) NOT NULL,        컬럼 # 2
    email VARCHAR(100) NOT NULL           컬럼 # 3
  );
```
이상을 Java로 풀게 되면
```java
public class User {
  @NonNull
  private int id;
  @NonNull
  private String username;
  @NonNull
  private String email;
}
```
과 유사하다고 보시면 되겠습니다.

2. DML 
  - 주요 명령어 : INSERT / SELECT / DELETE / UPDATE
  - 예시
```sql
INSERT INTO users (username, email) VALUES ('홍길동', 'honggildong@test.com');
insert into 테이블명 (컬럼명1, 컬럼명2, ... ) values(컬럼명1의값, 컬럼명2의값, ...);

SELECT * FROM users;
select 컬럼명1, 컬럼명2, FROM 테이블명;

UPDATE users SET email = 'new_email@example.com' WHERE id = 1;
update 테이블명 SET 고치려는컬럼명 = '고치려는컬럼명의값' WHERE 조건식;

DELETE FROM users WHERE id = 1;
delete from 테이블명 WHERE 조건식;
```

# 원하는 데이터를 가져오고 필터링 하는 법
## 데이터 처리 4 요소 : 생성 / 조회 / 수정 / 삭제
일단 저희는 현재 상황에서는 R에 집중할 예정입니다.
그래서 SQLD를 학습하시는 분들은 꼭꼭꼭꼭 추가학습이 요구됩니다.

### SELECT
1. 사전에 미리 데이터들이 있다고 가정할 때, 가장 중요한 부분으로 '어떤 데이터를 어디에서' 가지고 올까와 관련된 구문.

```sql
SELECT 'Hello SQL!';
```
이상의 결과값은 테이블명이 없고, Hello SQL!이라는 컬럼에, Hello SQL! row가 생성된 것을 확인할 수 있습니다.
그래서 select는 그냥 _~을 보여줘_ 라는 의미로 받아들이시면 되겠습니다.

```sql
select 12 + 7;
```
그래서 현재의 특정 테이블과 관계 없는 상황에서 string 값을 사용한다든지 혹은 연산을 하는 것도 가능합니다.

기본 예제
결과 창의 첫 행에 Find / Insight / with SQL을 3 개의 칸에 걸쳐 순서대로 출력해보겠습니다.
첫 번째 컬럼명은 Find
두 번째 컬럼명은 Insight
세 번째 컬럼명은 with SQL
이 될 거고
row 역시 각각 Find / Insight / with SQL
로 나오게 될겁니다.
```sql
SELECT 'Find', 'Insight', 'with SQL';
```
- 다수의 row 데이터를 순서대로 집어넣기 위해서는 `,`를 통해서 연결합니다.
```sql
SELECT 
	'Find' AS 'First', 
	'Insight' AS 'Second', 
	'with SQL' AS 'Third';
```
와 같은 방식을 AS 명령어를 사용하게 되면 각 row에 대한 column명을 지정할 수 있습니다 - '저희는' 쓸 일 없습니다.

연습 문제 

1. SELECT를 이용하여 28 + 891의 결과를 표시하라． 
2. SELECT를 이용하여 19 x 27의 결과를 표시하라 . 단, 컬럼명은 Result로 표시하라． 
3. SELECT를 이용하여 다음 세 가지 결과를 각각 다른 컬럼으로 결과창에 표시하라． 
  - 37 + 172 （단 , 컬럼명은 Plus로 표시하라 .) 
  - 25 x 78 （단 , 컬럼명은 Times로 표시하라 .) 
  - I love SQL! （단 , 컬럼명은 Result로 표시하라 .) 

```sql
SELECT 28 + 891;
SELECT 19 * 27 AS Result;
SELECT
  37 + 172 AS Plus,
  25 * 78 AS Times,
  'I love SQL!' AS Result;
```
이상의 경우 String 데이터(MariaDB 기준으로는 VARCHAR의 경우)는 큰따옴표든 작은따옴표든 구분하지 않습니다(일반적으로는). 하지만 컬럼명을 지정할 때는 없어도 될 때가 있습니다.

### FROM
- 데이터가 저장된 위치를 알려주는 전치사. 
1.
```sql
SELECT * FROM users;
```
* \* : 와일드카드라고도 하고, 애스터리스크(asterisk)라고 하기도 합니다. 여기서는 _모든 컬럼_ 을 나타내는 표현입니다.
```sql
SELECT *
  FROM products;
```
으로 작성하더라도 결과값에서는 차이가 없습니다. 이상에서 알 수 있는 것은 html 태그와 마찬가지로 개행을 하는 것을 컴퓨터가 신경쓰지 않는다는 것을 의미합니다.
다만 개발자들끼리는 적절한 개행을 통해 가독성있는 SQL을 쓰는 것을 원칙으로 합니다.

제품 정보 테이블 products에서 첫 3 개 행의 데이터만 가지고 오는 SQL (LIMIT에 주목)
```sql
SELECT *
  FROM products
  LIMIT 3
  ;
```
아까까지는 전체 테이블을 all rows를 다 불러왔는데, 모든 정보를 조회하는 것을 full scan이라는 표현을 씁니다. 그런데 테이블에 데이터가 엄청나게 많다면 그 데이터들을 불러오는 데에 컴퓨터가 많은 리소스를 쓰기 때문에 작업이 원활하지 않을 수 있어 full scan 자체는 지양되는 편입니다. 그래서 단순히 데이터의 상태를 파악하고 싶다면 LIMIT을 추가하여 일부 데이터만 확인하는 습관을 들이는 것이 좋습니다.
* MariaDB에서는 LIMIT을 쓰지만 Oracle / MySQL에서는 TOP 명령어를 사용합니다.

연습 문제
products 테이블에서 제품 아이디(id), 제품명(name) 컬럼의 데이터들만 상위 30개만 추출하는 SQL문을 작성하시오.

```sql
SELECT id, name
  FROM products
  LIMIT 30
  ;
```

1. orderdetails 테이블의 전체 컬럼을 표시하시오.
2. users에서 상위 7 건의 데이터만 표시하시오.
3. orders에서 주문 아이디 / 회원 아이디 / 주문 일자 컬럼의 모든 데이터를 표시하시오.
```sql
SELECT * FROM orderdetails;
SELECT * FROM users LIMIT 7;
SELECT 
  id, user_id, order_date 
  FROM orders
  ;
```
### WHERE
- 어떤 것을 고를까?
- SELECT / FROM을 통해서 어떤 테이블의 어떤 컬럼을 보여줄 지를 정했습니다. 거기에 LIMIT을 이용해서 상위에 있는 데이터들을 뽑아낼 수도 있었습니다.
- 하지만 이상의 통제가 _특정 조건_ 을 만족시키는 row를 가지고 온다고 할 수는 없습니다.
- 예를 들어, 특정 컬럼의 값이 A인 값만 가지고 온다든지, 여성인 회원의 정보만 가지고 온다든지, 마케팅 수신 동의를 한 사람들만 뽑아내서 그 사람들에게 광고 문자를 보낸다든지 등의 _조건_ 을 만족시키는 데이터만 조회하는 것 역시 매우 중요하다고 할 수 있겠습니다.

- SELECT에서는 테이블의 세로 부분인 컬럼을 제어했다면(어떤 컬럼을 보여줄 것인지), WHERE에서는 테이블의 가로 부분인 row를 제어하게 될겁니다.


회원 정보 테이블 users에서 거주 국가(country)가 한국(Korea)이면서, 동시에 마케팅 수신 동의(is_marketing_agree)를 동의(1)한 데이터를 추출하는 쿼리문
```sql
SELECT * 
	FROM users 
	WHERE
		country = 'Korea'
		and
		is_marketing_agree = 1
	;
```
그렇다면, 회원 정보 테이블 users에서 거주 국가(country)가 한국(Korea)이 아닌 데이터를 추출하는 쿼리문을 작성하시오.

```sql
SELECT * 
	FROM users 
	WHERE
		country != 'Korea'
    ;
```

회원 정보 테이블에서 거주국가가 한국이면서 id가 10인 회원만 추출하시오(결과값은 하나거나 아니면 없겠네요).

```sql
SELECT * 
	FROM users 
	WHERE
		country = 'Korea'
    AND
    id = 10
    ;
```

